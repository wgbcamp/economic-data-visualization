import React, { useEffect, useState } from "react";
import LineGraph from "./lineGraph.js"

export default function App() {

  // holds .json array after being formatted by loadData()
  const [data, setData] = useState();

  // load data to send to LineGraph component
  useEffect(() => {
    loadData();
  }, []);

  // determine which .json file to fetch
  var GDP = [
    {
      "name": "USA",
      "data": [
          ["2010-01-01T01:00:00Z", 15048.975], 
          ["2011-01-01T01:00:00Z", 15599.725],
          ["2012-01-01T01:00:00Z", 16253.95],
          ["2013-01-01T01:00:00Z", 16880.675], 
          ["2014-01-01T01:00:00Z", 17608.125],
          ["2015-01-01T01:00:00Z", 18295],
          ["2016-01-01T01:00:00Z", 18804.9], 
          ["2017-01-01T01:00:00Z", 19612.1],
          ["2018-01-01T01:00:00Z", 20656.525],
          ["2019-01-01T01:00:00Z", 21539.975], 
          ["2020-01-01T01:00:00Z", 21354.125]
          ],
      "selected": true
      },
      {
      "name": "Canada",
      "data": [
        ["2010-01-01T01:00:00Z", 1617.345], 
        ["2011-01-01T01:00:00Z", 1793.327],
        ["2012-01-01T01:00:00Z", 1828.362],
        ["2013-01-01T01:00:00Z", 1846.595], 
        ["2014-01-01T01:00:00Z", 1805.751],
        ["2015-01-01T01:00:00Z", 1556.508],
        ["2016-01-01T01:00:00Z", 1527.996], 
        ["2017-01-01T01:00:00Z", 1649.266],
        ["2018-01-01T01:00:00Z", 1725.3],
        ["2019-01-01T01:00:00Z", 1743.725], 
        ["2020-01-01T01:00:00Z", 1655.685]
          ],
      "selected": true
      },
      {
      "name": "Germany",
      "data": [
        ["2010-01-01T01:00:00Z", 3470.987], 
        ["2011-01-01T01:00:00Z", 3824.155],
        ["2012-01-01T01:00:00Z", 3600.175],
        ["2013-01-01T01:00:00Z", 3808.142], 
        ["2014-01-01T01:00:00Z", 3966.823],
        ["2015-01-01T01:00:00Z", 3423.915],
        ["2016-01-01T01:00:00Z", 3536.808], 
        ["2017-01-01T01:00:00Z", 3761.764],
        ["2018-01-01T01:00:00Z", 4053.846],
        ["2019-01-01T01:00:00Z", 3957.645], 
        ["2020-01-01T01:00:00Z", 3936.989]
          ],
      "selected": true
      },
      {
      "name": "India",
      "data": [
        ["2010-01-01T01:00:00Z", 1675.615], 
        ["2011-01-01T01:00:00Z", 1823.052],
        ["2012-01-01T01:00:00Z", 1827.637],
        ["2013-01-01T01:00:00Z", 1856.721], 
        ["2014-01-01T01:00:00Z", 2039.127],
        ["2015-01-01T01:00:00Z", 2103.588],
        ["2016-01-01T01:00:00Z", 2294.797], 
        ["2017-01-01T01:00:00Z", 2651.474],
        ["2018-01-01T01:00:00Z", 2702.93],
        ["2019-01-01T01:00:00Z", 2835.606], 
        ["2020-01-01T01:00:00Z", 2674.852]
          ],
      "selected": true
      },
      {
      "name": "Brazil",
      "data": [
        ["2010-01-01T01:00:00Z", 2208.704], 
        ["2011-01-01T01:00:00Z", 2614.027],
        ["2012-01-01T01:00:00Z", 2464.053],
        ["2013-01-01T01:00:00Z", 2471.718], 
        ["2014-01-01T01:00:00Z", 2456.055],
        ["2015-01-01T01:00:00Z", 1800.046],
        ["2016-01-01T01:00:00Z", 1796.622], 
        ["2017-01-01T01:00:00Z", 2063.519],
        ["2018-01-01T01:00:00Z", 1916.934],
        ["2019-01-01T01:00:00Z", 1873.286], 
        ["2020-01-01T01:00:00Z", 1476.092]
          ],
      "selected": true
      }
  ]

  var inflation = [
    {
      "name": "USA",
      "data": [
        ["2010-01-01T01:00:00Z", 1.6], 
        ["2011-01-01T01:00:00Z", 3.1],
        ["2012-01-01T01:00:00Z", 2.1],
        ["2013-01-01T01:00:00Z", 1.5], 
        ["2014-01-01T01:00:00Z", 1.6],
        ["2015-01-01T01:00:00Z", 0.1],
        ["2016-01-01T01:00:00Z", 1.3], 
        ["2017-01-01T01:00:00Z", 2.1],
        ["2018-01-01T01:00:00Z", 2.4],
        ["2019-01-01T01:00:00Z", 1.8], 
        ["2020-01-01T01:00:00Z", 1.2]
          ],
      "selected": true
      },
      {
      "name": "Canada",
      "data": [
        ["2010-01-01T01:00:00Z", 1.8], 
        ["2011-01-01T01:00:00Z", 2.9],
        ["2012-01-01T01:00:00Z", 1.5],
        ["2013-01-01T01:00:00Z", 0.9], 
        ["2014-01-01T01:00:00Z", 1.9],
        ["2015-01-01T01:00:00Z", 1.1],
        ["2016-01-01T01:00:00Z", 1.4], 
        ["2017-01-01T01:00:00Z", 1.6],
        ["2018-01-01T01:00:00Z", 2.3],
        ["2019-01-01T01:00:00Z", 1.9], 
        ["2020-01-01T01:00:00Z", 0.7]
          ],
      "selected": true
      },
      {
      "name": "Germany",
      "data": [
        ["2010-01-01T01:00:00Z", 1.1], 
        ["2011-01-01T01:00:00Z", 2.5],
        ["2012-01-01T01:00:00Z", 2.2],
        ["2013-01-01T01:00:00Z", 1.6], 
        ["2014-01-01T01:00:00Z", 0.8],
        ["2015-01-01T01:00:00Z", 0.7],
        ["2016-01-01T01:00:00Z", 0.4], 
        ["2017-01-01T01:00:00Z", 1.7],
        ["2018-01-01T01:00:00Z", 1.9],
        ["2019-01-01T01:00:00Z", 1.4], 
        ["2020-01-01T01:00:00Z", 0.4]
          ],
      "selected": true
      },
      {
      "name": "India",
      "data": [
        ["2010-01-01T01:00:00Z", 9.4], 
        ["2011-01-01T01:00:00Z", 8.1],
        ["2012-01-01T01:00:00Z", 10],
        ["2013-01-01T01:00:00Z", 9.4], 
        ["2014-01-01T01:00:00Z", 5.8],
        ["2015-01-01T01:00:00Z", 4.9],
        ["2016-01-01T01:00:00Z", 4.5], 
        ["2017-01-01T01:00:00Z", 3.6],
        ["2018-01-01T01:00:00Z", 3.4],
        ["2019-01-01T01:00:00Z", 4.8], 
        ["2020-01-01T01:00:00Z", 6.2]
          ],
      "selected": true
      },
      {
      "name": "Brazil",
      "data": [
        ["2010-01-01T01:00:00Z", 5], 
        ["2011-01-01T01:00:00Z", 6.6],
        ["2012-01-01T01:00:00Z", 5.4],
        ["2013-01-01T01:00:00Z", 6.2], 
        ["2014-01-01T01:00:00Z", 6.3],
        ["2015-01-01T01:00:00Z", 9],
        ["2016-01-01T01:00:00Z", 8.7], 
        ["2017-01-01T01:00:00Z", 3.4],
        ["2018-01-01T01:00:00Z", 3.7],
        ["2019-01-01T01:00:00Z", 3.7], 
        ["2020-01-01T01:00:00Z", 3.2]
          ],
      "selected": true
      }
    ]

  var unemploy = [
    {
      "name": "USA",
      "data": [
        ["2010-01-01T01:00:00Z", 9.6], 
        ["2011-01-01T01:00:00Z", 8.9],
        ["2012-01-01T01:00:00Z", 8.1],
        ["2013-01-01T01:00:00Z", 7.4], 
        ["2014-01-01T01:00:00Z", 6.2],
        ["2015-01-01T01:00:00Z", 5.3],
        ["2016-01-01T01:00:00Z", 4.9], 
        ["2017-01-01T01:00:00Z", 4.4],
        ["2018-01-01T01:00:00Z", 3.9],
        ["2019-01-01T01:00:00Z", 3.7], 
        ["2020-01-01T01:00:00Z", 8.1]
          ],
      "selected": true
      },
      {
      "name": "Canada",
      "data": [
        ["2010-01-01T01:00:00Z", 8.1], 
        ["2011-01-01T01:00:00Z", 7.6],
        ["2012-01-01T01:00:00Z", 7.4],
        ["2013-01-01T01:00:00Z", 7.2], 
        ["2014-01-01T01:00:00Z", 7],
        ["2015-01-01T01:00:00Z", 7],
        ["2016-01-01T01:00:00Z", 7], 
        ["2017-01-01T01:00:00Z", 6.4],
        ["2018-01-01T01:00:00Z", 5.9],
        ["2019-01-01T01:00:00Z", 5.7], 
        ["2020-01-01T01:00:00Z", 9.7]
          ],
      "selected": true
      },
      {
      "name": "Germany",
      "data": [
        ["2010-01-01T01:00:00Z", 6.6], 
        ["2011-01-01T01:00:00Z", 5.5],
        ["2012-01-01T01:00:00Z", 5.1],
        ["2013-01-01T01:00:00Z", 5], 
        ["2014-01-01T01:00:00Z", 4.7],
        ["2015-01-01T01:00:00Z", 4.4],
        ["2016-01-01T01:00:00Z", 3.9], 
        ["2017-01-01T01:00:00Z", 3.6],
        ["2018-01-01T01:00:00Z", 3.2],
        ["2019-01-01T01:00:00Z", 3], 
        ["2020-01-01T01:00:00Z", 3.6]
          ],
      "selected": true
      },
      {
      "name": "India",
      "data": [

          ],
      "selected": true
      },
      {
      "name": "Brazil",
      "data": [
        ["2010-01-01T01:00:00Z", 1.6], 
        ["2011-01-01T01:00:00Z", 3.1],
        ["2012-01-01T01:00:00Z", 2.1],
        ["2013-01-01T01:00:00Z", 1.5], 
        ["2014-01-01T01:00:00Z", 1.6],
        ["2015-01-01T01:00:00Z", 0.1],
        ["2016-01-01T01:00:00Z", 1.3], 
        ["2017-01-01T01:00:00Z", 2.1],
        ["2018-01-01T01:00:00Z", 2.4],
        ["2019-01-01T01:00:00Z", 1.8], 
        ["2020-01-01T01:00:00Z", 1.2]
          ],
      "selected": true
      }
    ]

  // save object to variable based on selection from child component
  const loadData = (value) => {
    var x;
    if (value === "GDP") {
        x = GDP;
    } else if (value === "Inf") {
        x = inflation;
    } else if (value === "Une") {
        x = unemploy;
    } else {
        x = GDP;
    }

    // replace the date array values with unix epoch time for
    // compatibility with the Highcharts x axis in the LineGraph component
    for (var i=0; i<x.length; i++) {
      console.log(x[i].data)
      for (var a=0; a<x[i].data.length; a++) {
        console.log(x[i].data[a][0])
        x[i].data[a].splice(0, 1, Date.parse(x[i].data[a][0]))
      }
    }
        setData(x);
  };
  
    
  // original fetch statement to separate .json files 
    
  // const loadData = async (value) => {
  //   if (value === "GDP") {
  //       value = "gdp";
  //   } else if (value === "Inf") {
  //       value = "inflation";
  //   } else if (value === "Une") {
  //       value = "unemploy";
  //   } else {
  //     value = "gdp";
  //   }

  //   // fetch json
  //   const response = await fetch(`/${value}.json`, { method: 'GET' });
  //   var x = await response.json();

  //   // replace the date array values with unix epoch time for
  //   // compatibility with the Highcharts x axis in the LineGraph component
  //   for (var i=0; i<x.length; i++) {
  //     console.log(x[i].data)
  //     for (var a=0; a<x[i].data.length; a++) {
  //       console.log(x[i].data[a][0])
  //       x[i].data[a].splice(0, 1, Date.parse(x[i].data[a][0]))
  //     }
  //   }
  //       setData(x);
  // };



  return (
    <div className="App">
      <LineGraph getJson={loadData} data={data}/>
    </div>
  );
}
